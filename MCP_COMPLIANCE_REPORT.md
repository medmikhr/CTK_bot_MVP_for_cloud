# MCP Streamable HTTP Transport - –û—Ç—á–µ—Ç –æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏

## –û–±–∑–æ—Ä
–î–∞–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ MCP Streamable HTTP Transport –≤–µ—Ä—Å–∏–∏ 2025-03-26.

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç
- **HTTP POST –∑–∞–ø—Ä–æ—Å—ã**: –í—Å–µ JSON-RPC —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ HTTP POST
- **Accept –∑–∞–≥–æ–ª–æ–≤–∫–∏**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `application/json` –∏ `text/event-stream`
- **Server-Sent Events (SSE)**: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è SSE —Å ID —Å–æ–±—ã—Ç–∏–π
- **Content-Type**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ `application/json` –∏ `text/event-stream`

### –ú–µ—Ç–æ–¥—ã HTTP
- **POST**: –û—Ç–ø—Ä–∞–≤–∫–∞ JSON-RPC –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É
- **GET**: –ü–æ–ª—É—á–µ–Ω–∏–µ SSE –ø–æ—Ç–æ–∫–æ–≤ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (listen mode)
- **DELETE**: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–µ—Å—Å–∏–π
- **OPTIONS**: CORS preflight –∑–∞–ø—Ä–æ—Å—ã

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏
- **Session ID**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö ID —Å–µ—Å—Å–∏–π
- **Mcp-Session-Id –∑–∞–≥–æ–ª–æ–≤–æ–∫**: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö –∏ –æ—Ç–≤–µ—Ç–∞—Ö
- **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–µ—Å—Å–∏–π**: DELETE –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è —è–≤–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–ü—Ä–∏–≤—è–∑–∫–∞ –∫ localhost**: –°–µ—Ä–≤–µ—Ä –ø—Ä–∏–≤—è–∑–∞–Ω —Ç–æ–ª—å–∫–æ –∫ 127.0.0.1
- **Origin validation**: –ü—Ä–æ–≤–µ—Ä–∫–∞ Origin –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç DNS rebinding
- **CORS**: –ë–∞–∑–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ CORS –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### JSON-RPC –ø—Ä–æ—Ç–æ–∫–æ–ª
- **–í–µ—Ä—Å–∏—è 2.0**: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ JSON-RPC 2.0
- **Batch requests**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∞—Å—Å–∏–≤–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤
- **Error handling**: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –∫–æ–¥–∞–º–∏

## üîß MCP –ú–µ—Ç–æ–¥—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã
- ‚úÖ `initialize` - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- ‚úÖ `tools/list` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ `tools/call` - –í—ã–∑–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ `resources/list` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
- ‚úÖ `prompts/list` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤

### Capabilities (–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
```json
{
  "tools": {"listChanged": false},
  "resources": {"subscribe": false, "listChanged": false},
  "prompts": {"listChanged": false}
}
```

## üöÄ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°–µ—Ä–≤–µ—Ä (`mcp_streamable_server.py`)
- –ö–ª–∞—Å—Å `MCPStreamableServer` 
- HTTP endpoint –Ω–∞ `/mcp`
- Health check –Ω–∞ `/health`
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏
- SSE –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å event IDs

### –ö–ª–∏–µ–Ω—Ç (`mcp_streamable_client.py`)
- –ö–ª–∞—Å—Å `MCPStreamableClient`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ session ID
- SSE parsing —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å–æ–±—ã—Ç–∏–π
- –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä MCP –º–µ—Ç–æ–¥–æ–≤

## üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
–ö–ª–∏–µ–Ω—Ç –≤–∫–ª—é—á–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã:
1. Health check —Å–µ—Ä–≤–µ—Ä–∞
2. Initialize handshake
3. Tools listing –∏ –≤—ã–∑–æ–≤—ã
4. Resources –∏ prompts listing
5. Session termination

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–ü–æ–¥–¥–µ—Ä–∂–∫–∞ curl –¥–ª—è:
- JSON responses (`Accept: application/json`)
- SSE streams (`Accept: text/event-stream`)
- –í—Å–µ HTTP –º–µ—Ç–æ–¥—ã

## üåê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
python mcp_streamable_server.py
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
python mcp_streamable_client.py
```

### curl –ø—Ä–∏–º–µ—Ä—ã
```bash
# Health check
curl http://127.0.0.1:8080/health

# Initialize
curl -X POST -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -d '{"jsonrpc":"2.0","id":1,"method":"initialize","params":{"protocolVersion":"2025-03-26","capabilities":{},"clientInfo":{"name":"test","version":"1.0"}}}' \
  http://127.0.0.1:8080/mcp
```

## üîí –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **Localhost binding**: –°–µ—Ä–≤–µ—Ä –ø—Ä–∏–≤—è–∑–∞–Ω —Ç–æ–ª—å–∫–æ –∫ 127.0.0.1
2. **Origin validation**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö origins
3. **Session management**: –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ UUID session IDs
4. **Error handling**: –ù–µ—Ç —É—Ç–µ—á–µ–∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ MCP Streamable HTTP Transport 2025-03-26:

- ‚úÖ –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTP –º–µ—Ç–æ–¥–æ–≤
- ‚úÖ SSE –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å —Å–æ–±—ã—Ç–∏—è–º–∏
- ‚úÖ Session management
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ Comprehensive —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –¥–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ MCP —Å–µ—Ä–≤–µ—Ä–∞.
